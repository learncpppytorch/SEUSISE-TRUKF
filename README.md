Update on June 9th: The previous version of the code had some missing parts, which have now been fully supplemented
